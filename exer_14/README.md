# C# 实现网络文件传输

## V0.1

**本程序实现服务端/客户端的网络通信**

> DATA:2017-08-24
>
> TIME:11:48
>
> AUTHOR:DORTHYN

利用*NetworkStream* 类 (System.Net.Sockets)的write和read循环读写的方法实现文件传输功能，可以在本版的基础上增加断点续传和md5校验功能，实现思路：通过客户端本地保存读取进度的方式，在下一次重新建立连接发起下载任务的时候通知服务端当前剩余文件大小，接续读写。本地文件保存可以采用XML文件保存的方式。

**本次练习的难点**：write和read不同步的问题，正确的方式本应该是客户端向服务端发起下载请求，即调用read方法，之后服务器端再写，也就是读完再写。而之前的问题在于，客户端未将服务器发过来的数据包读完，服务器又接着往networkstream里写，导致数据丢失，程序崩溃。

**解决办法**：客户端每包数据接收完毕后，给服务端程序报告一次，确认接收完毕后服务器再写入下一数据包。